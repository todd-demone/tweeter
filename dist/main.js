!function(){"use strict";var e=["second","minute","hour","day","week","month","year"],t=["秒","分钟","小时","天","周","个月","年"],n={},a=function(e,t){n[e]=t},r=[60,60,24,7,365/7/12,12];function o(e){return e instanceof Date?e:!isNaN(e)||/^\d+$/.test(e)?new Date(parseInt(e)):(e=(e||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(e))}a("en_US",(function(t,n){if(0===n)return["just now","right now"];var a=e[Math.floor(n/2)];return t>1&&(a+="s"),[t+" "+a+" ago","in "+t+" "+a]})),a("zh_CN",(function(e,n){if(0===n)return["刚刚","片刻后"];var a=t[~~(n/2)];return[e+" "+a+"前",e+" "+a+"后"]}));var c=140,s=function(e){var t=$(".new-tweet .error");t.children(".msg").html(e),t.slideDown(),$("#tweet-textarea").focus()},i=function(e){return'\n    <article class="tweet">\n      <header>\n        <div class="avatar-and-name">\n          <img src="'.concat(e.user.avatars,'" alt="small-avatar" width="48" height="48">\n          <span class="name">').concat(e.user.name,'</span>\n        </div>\n        <div class="handle">\n          <span>').concat(e.user.handle,"</span>\n        </div>\n      </header>\n      <main>").concat((i=e.content.text,l=document.createElement("div"),l.appendChild(document.createTextNode(i)),l.innerHTML),'</main>\n      <footer>\n        <span class="date">').concat((t=e.created_at,s=function(e,t){return(+(t?o(t):new Date)-+o(e))/1e3}(t,c&&c.relativeDate),function(e,t){for(var n=e<0?1:0,a=e=Math.abs(e),o=0;e>=r[o]&&o<r.length;o++)e/=r[o];return(e=Math.floor(e))>(0==(o*=2)?9:1)&&(o+=1),t(e,o,a)[n].replace("%s",e.toString())}(s,function(e){return n[e]||n.en_US}(a))),'</span>\n        <div>\n          <i class="fa-solid fa-flag"></i>\n          <i class="fa-solid fa-retweet"></i>\n          <i class="fa-solid fa-heart"></i>\n        </div>\n      </footer>\n    </article>\n  ');var t,a,c,s,i,l},l=function(){$.get("/tweets").then((function(e){return function(e){var t="";e.forEach((function(e){return t+=i(e)})),$("#tweets-container").html("").append(t)}(e)})).catch((function(e){$(".new-tweet").slideDown(),s("Error: Tweets aren't available at this time (".concat(e.status," ").concat(e.statusText,")"))}))};$((function(){var e,t;l(),(e=$("#nav-buttons")).on("click",".toggle-tweet",(function(){$(".new-tweet").slideToggle("slow"),$("#tweet-textarea").focus()})),e.on("click",".scroll-top",(function(e){var t=$(e.currentTarget),n=t.siblings(".toggle-tweet");$("html, body").animate({scrollTop:0}).promise().then((function(){t.slideUp("slow"),n.slideDown("slow"),$(".new-tweet").slideDown("slow"),$("#tweet-textarea").focus()}))})),$(window).on("scroll",(function(e){var t=$(e.currentTarget).scrollTop(),n=$(".scroll-top"),a=n.siblings(".toggle-tweet");t>150?(n.slideDown("slow"),a.slideUp()):(n.slideUp("slow"),a.slideDown("slow"))})),(t=$("#tweet-form")).on("submit keydown",(function(e){if("submit"===e.type||13===e.keyCode){var n=t.serialize(),a=t.children("#tweet-textarea").val();if(e.preventDefault(),!function(e){return e?!(e.length>c&&(s("Tweets can't exceed ".concat(c," characters.")),1)):(s("You can't send an empty tweet."),!1)}(a))return!1;$.post("/tweets",n).then((function(){l(),t.trigger("reset").find(".counter").text(c)})).catch((function(e){return s("Error: Your tweet did not get sent (".concat(e.status," ").concat(e.statusText,")"))}))}})),t.on("input","#tweet-textarea",(function(e){var n=$(e.currentTarget).val(),a=t.find(".counter"),r=t.siblings(".error");n.length>c?(a.addClass("negative"),s("Tweets can't exceed ".concat(c," characters."))):(a.removeClass("negative"),r.slideUp()),a.text(c-n.length)}))}))}();