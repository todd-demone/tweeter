(()=>{"use strict";const e=140,t=e=>{const t=$(".new-tweet .error");t.children(".msg").html(e),t.slideDown(),$("#tweet-textarea").focus()},n=e=>`\n    <article class="tweet">\n      <header>\n        <div class="avatar-and-name">\n          <img src="${e.user.avatars}" alt="small-avatar" width="48" height="48">\n          <span class="name">${e.user.name}</span>\n        </div>\n        <div class="handle">\n          <span>${e.user.handle}</span>\n        </div>\n      </header>\n      <main>${(e=>{let t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML})(e.content.text)}</main>\n      <footer>\n        <span class="date">${timeago.format(e.created_at)}</span>\n        <div>\n          <i class="fa-solid fa-flag"></i>\n          <i class="fa-solid fa-retweet"></i>\n          <i class="fa-solid fa-heart"></i>\n        </div>\n      </footer>\n    </article>\n  `,s=()=>{$.get("/tweets").then((e=>(e=>{let t="";e.forEach((e=>t+=n(e))),$("#tweets-container").html("").append(t)})(e))).catch((e=>{$(".new-tweet").slideDown(),t(`Error: Tweets aren't available at this time (${e.status} ${e.statusText})`)}))};$((()=>{s(),(()=>{const e=$("#nav-buttons");e.on("click",".toggle-tweet",(()=>{$(".new-tweet").slideToggle("slow"),$("#tweet-textarea").focus()})),e.on("click",".scroll-top",(e=>{const t=$(e.currentTarget),n=t.siblings(".toggle-tweet");$("html, body").animate({scrollTop:0}).promise().then((()=>{t.slideUp("slow"),n.slideDown("slow"),$(".new-tweet").slideDown("slow"),$("#tweet-textarea").focus()}))}))})(),$(window).on("scroll",(e=>{const t=$(e.currentTarget).scrollTop(),n=$(".scroll-top"),s=n.siblings(".toggle-tweet");t>150?(n.slideDown("slow"),s.slideUp()):(n.slideUp("slow"),s.slideDown("slow"))})),(()=>{const n=$("#tweet-form");n.on("submit keydown",(a=>{if("submit"===a.type||13===a.keyCode){const l=n.serialize(),r=n.children("#tweet-textarea").val();if(a.preventDefault(),!(n=>n?!(n.length>e&&(t("Tweets can't exceed 140 characters."),1)):(t("You can't send an empty tweet."),!1))(r))return!1;$.post("/tweets",l).then((()=>{s(),n.trigger("reset").find(".counter").text(e)})).catch((e=>t(`Error: Your tweet did not get sent (${e.status} ${e.statusText})`)))}})),n.on("input","#tweet-textarea",(s=>{const a=$(s.currentTarget).val(),l=n.find(".counter"),r=n.siblings(".error");a.length>e?(l.addClass("negative"),t("Tweets can't exceed 140 characters.")):(l.removeClass("negative"),r.slideUp()),l.text(e-a.length)}))})()}))})();